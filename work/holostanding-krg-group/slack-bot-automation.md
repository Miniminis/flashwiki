# 슬랙봇을 이용한 서비스 모니터링 시스템 구축

## 1. 배경&#x20;

우리 서비스는 `알리고`라는 SMS/카카오알림톡 전송 서비스를 이용하고 있다. API 문서도 잘 갖추어져있고, 웹 상에서 직접 보내는 것도 가능해서 여러모로 만족스럽게 사용하고 있지만, 딱 한가지, 선불 충전식이라는 점이 정말 아쉽다. 쓴만큼 월 말에 결제하는 형식이 아니라서, 고객들에게 보낼 문자나 카카오 알림톡이 잘 보내질 수 있게 충분한 금액이 존재하는지 늘 확인할 필요가 있다.&#x20;

또한 우리 서비스는 새벽이나 낮 시간대에 자동으로 실행되는 배치 프로그램이 있다. 배치 프로그램이 정상적으로 실행되었는지, 알려주는 시스템이 없다보니, 매번 데이터베이스를 조회해서 그 결과를 확인해아한다는 아쉬움이 있었다. &#x20;

## 2. 문제정의

서비스 운영과 관련하여 여러 플랫폼에 걸쳐서 일일히 모니터링을 해야된다는 점은 시간도 많이 들고, 업무 효율적으로도 좋지 않다. 서비스 운영에 필요한 부분들을 자동으로 모니터링 할 수 있도록 시스템을 구축할 필요성이 있다.&#x20;

* 서버를 통해 자동으로 전송되는 `알림톡`의 경우, 선불 충전식이라서 미리 충전되지 않는 경우, 사용자들에게 전달될 메시지가 누락될 수 있다.
* 새벽이나 낮 정해진 시간에 실행되는 백그라운드 배치 프로세스의 경우, 그 실행 결과 및 수행시간을 확인하여 정상적으로 프로세스가 실행되었는지 모니터링이 필요하다.

## 3. 해결방법

* 사내 메신저로 활발히 이용중이던 Slack 서비스를 통해 자동 모니터링 봇으로 모니터링 프로세스를 구축했다.
* 배치 프로세스의 경우, 개발팀으로 한정하여 해당 내용을 볼 수 있도록 하여 굳이 알필요 없는 팀원들에게는 알림이 가지 않도록 했다.
* 선불 충전식 알림톡 서비스의 경우, 발송 가능한 메시지의 수가 특정 건수 이하로 떨어지면 슬랙봇 메시지가 전달되도록 했다.
  * 결제 담당자를 자동으로 태그하고 결제에 쓰이는 은행과 계좌번호도 메시지 내용에 담아, 메시지를 확인한 담당자가 바로 충전할 수 있도록 했다.&#x20;

![](<../../.gitbook/assets/slackbot-01.png>)

![](<../../.gitbook/assets/slackbot-02.png>)


## 4. 나의 역할

* 서비스 모니터링 업무를 자동화하기 위한 슬랙봇을 만들어 팀원들이 서비스 모니터링에 대한 부담을 덜 수 있도록 했다.

## 5. 성과

* 선불식 알림톡 서비스 미충전으로 인한 인증번호 문자 발송 오류가 없어지게 되었다. 인증번호 문자 미발송으로 인해 투어신청에 실패하는 경우가 없어졌으므로 **매출에 직접적으로 위협이 가는 요소를 하나 제거**하게 되었다.
  * 참고) 홀로스탠딩에서는 휴대폰번호 인증을 거쳐야 투어신청을 완료할 수 있다. 투어 신청수는 온라인 단계에서 가장 중요한 KPI 이다.
* 데이터베이스 상에서 일일히 확인해야했던 배치 프로세스 결과를 한 곳에서 빠르게 확인할 수 있게 되었다. **일 평균 10-15분 소요되던 업무시간이 1분으로 줄어들었다.**
* 슬랙 알림을 통해 모니터링이 가능하니, 장애에 대한 대응 속도도 이전보다 훨씬 빨라졌다.

## 6. 느낀점 / 배운점

* 모니터링과 같은 업무는 특히 반복적이고 시간이 많이 소요된다는 점에서 자동화 1순위라고 생각된다. 단 10분이라도 매일매일 반복되는 업무가 있다면 자동화의 대상이 될 수 있다.
* 모니터링은 모든 구성원이 접근하기 쉬운 플랫폼에서 이루어지도록 하는게 좋다. 이전에 이메일 등으로 모니터링 자동화를 시도했지만, 슬랙보다 접근성이 떨어져서 실패했던 경험이 있다. 슬랙으로 모니터링을 진행하도록 한 이후에는 훨씬 편하고 빠르게 업무를 수행할 수 있었다.
